# üöó –í—Ä—É–º-–≤—Ä—É–º –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è - –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä

## üì¶ –ß—Ç–æ –∑–∞ —Ñ–∞–π–ª .pcapng?

### PCAPNG (Packet Capture Next Generation)
–≠—Ç–æ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –¥–ª—è **–∑–∞—Ö–≤–∞—Ç–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞**.

**–ê–Ω–∞–ª–æ–≥–∏—è:**
- –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç–µ –≤–µ—Å—å —Ä–∞–∑–≥–æ–≤–æ—Ä –º–µ–∂–¥—É –¥–≤—É–º—è –ª—é–¥—å–º–∏
- .pcapng - —ç—Ç–æ "–º–∞–≥–Ω–∏—Ç–æ—Ñ–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å" –≤—Å–µ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –±–∞–π—Ç –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ —Å–µ—Ç–∏

**–°–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é:**
- **Wireshark** - –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å GUI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- **tcpdump** - –∫–æ–Ω—Å–æ–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞
- **tshark** - –∫–æ–Ω—Å–æ–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Wireshark

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- HTTP –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
- TCP/UDP –ø–∞–∫–µ—Ç—ã
- DNS –∑–∞–ø—Ä–æ—Å—ã
- –ó–∞–≥–æ–ª–æ–≤–∫–∏, –¥–∞–Ω–Ω—ã–µ, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
- –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ

---

## üéØ –°—É—Ç—å –∑–∞–¥–∞–Ω–∏—è

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç—Ä–∞—Ñ–∏–∫–µ:

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/custom-message` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```
custom_message_name=flag
custom_message_value=D    <-- –ë–£–ö–í–ê –§–õ–ê–ì–ê!
custom_message_event=
```

**–ö–∞–∂–¥—ã–π HTTP –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–¥–∞–µ—Ç –û–î–ù–£ –±—É–∫–≤—É —Ñ–ª–∞–≥–∞!**

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤:
```
1. custom_message_value=D
2. custom_message_value=U
3. custom_message_value=C
4. custom_message_value=K
5. custom_message_value=E
6. custom_message_value=R
7. custom_message_value=Z
8. custom_message_value=%7B   <- —ç—Ç–æ { –≤ URL encoding
9. custom_message_value=c
10. custom_message_value=4
...
```

---

## üîß –ú–µ—Ç–æ–¥ —Ä–µ—à–µ–Ω–∏—è (–ø–æ—à–∞–≥–æ–≤–æ)

### –®–∞–≥ 1: –ò–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ pcapng
```bash
strings VroomVroom.pcapng
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `strings`:**
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ —á–∏—Ç–∞–µ–º—ã–µ ASCII —Å—Ç—Ä–æ–∫–∏ –∏–∑ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- HTTP - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- –í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç –≤ pcapng
- `strings` –º–æ–∂–µ—Ç –∏—Ö –∏–∑–≤–ª–µ—á—å –±–µ–∑ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ñ–æ—Ä–º–∞—Ç–∞ pcapng

---

### –®–∞–≥ 2: –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ —Å "flag"
```bash
strings VroomVroom.pcapng | grep flag
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
custom_message_name=flag&custom_message_value=D&custom_message_event=
custom_message_name=flag&custom_message_value=U&custom_message_event=
custom_message_name=flag&custom_message_value=C&custom_message_event=
...
```

---

### –®–∞–≥ 3: –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ (–ø–µ—Ä–≤—ã–π awk)
```bash
... | awk -F'=' '{ print $3 }'
```

**–†–∞–∑–±–æ—Ä:**
- `-F'='` - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —ç—Ç–æ `=`
- `{ print $3 }` - –ø–µ—á–∞—Ç–∞–µ–º 3-–µ –ø–æ–ª–µ

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:
custom_message_name=flag&custom_message_value=D&custom_message_event=
                    ^1   ^2                    ^3                     ^4

–ü–æ–ª–µ 1: custom_message_name
–ü–æ–ª–µ 2: flag&custom_message_value
–ü–æ–ª–µ 3: D&custom_message_event     <-- –ú–´ –ë–ï–†–ï–ú –≠–¢–û
–ü–æ–ª–µ 4: (–ø—É—Å—Ç–æ)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
D&custom_message_event=
U&custom_message_event=
C&custom_message_event=
...
```

---

### –®–∞–≥ 4: –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–µ–µ (–≤—Ç–æ—Ä–æ–π awk)
```bash
... | awk -F'&' '{ print $1 }'
```

**–†–∞–∑–±–æ—Ä:**
- `-F'&'` - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —ç—Ç–æ `&`
- `{ print $1 }` - –ø–µ—á–∞—Ç–∞–µ–º 1-–µ –ø–æ–ª–µ

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:
D&custom_message_event=
 ^1                    ^2

–ü–æ–ª–µ 1: D              <-- –ú–´ –ë–ï–†–ï–ú –≠–¢–û
–ü–æ–ª–µ 2: custom_message_event=
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
D
U
C
K
E
R
Z
%7B
c
4
...
```

---

### –®–∞–≥ 5: –°–∫–ª–µ–∏–≤–∞–µ–º –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É
```bash
... | tr -d '\n'
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `tr -d '\n'`:**
- `tr` - translate (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å–∏–º–≤–æ–ª—ã)
- `-d` - delete (—É–¥–∞–ª–∏—Ç—å)
- `'\n'` - —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
DUCKERZ%7Bc4n_f0r_DuCk5%7D
```

---

### –®–∞–≥ 6: URL –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
echo "DUCKERZ%7Bc4n_f0r_DuCk5%7D" | python3 -c "import sys; from urllib.parse import unquote; print(unquote(sys.stdin.read().strip()))"
```

**URL encoding:**
- `%7B` = `{` (—Ñ–∏–≥—É—Ä–Ω–∞—è —Å–∫–æ–±–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è)
- `%7D` = `}` (—Ñ–∏–≥—É—Ä–Ω–∞—è —Å–∫–æ–±–∫–∞ –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è)

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥:**
```
DUCKERZ{c4n_f0r_DuCk5}
```

---

## üî¨ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### –ú–µ—Ç–æ–¥ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tshark (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```bash
tshark -r VroomVroom.pcapng -Y "http" -T fields -e http.request.uri | grep custom-message
```

### –ú–µ—Ç–æ–¥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Wireshark GUI
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –≤ Wireshark
2. –§–∏–ª—å—Ç—Ä: `http.request.uri contains "custom-message"`
3. Follow HTTP Stream
4. –í—Ä—É—á–Ω—É—é —Å–æ–±—Ä–∞—Ç—å —Ñ–ª–∞–≥

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. Network Forensics (–°–µ—Ç–µ–≤–∞—è –∫—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏–∫–∞)
- –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–ª–∏–∫
- –í CTF - –ø–æ–∏—Å–∫ —Å–ø—Ä—è—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. HTTP Protocol
- –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- –õ–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### 3. Data Exfiltration (–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö)
- –í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ —Ñ–ª–∞–≥ "—É—Ç–µ–∫–∞–µ—Ç" –ø–æ –æ–¥–Ω–æ–π –±—É–∫–≤–µ
- –°–∏–º—É–ª–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è —É—Ç–µ—á–∫–∞ —Å–ª–æ–∂–Ω–µ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è

### 4. URL Encoding
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –≤ %XX —Ñ–æ—Ä–º–∞—Ç
- `{` –∏ `}` –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ URL –Ω–∞–ø—Ä—è–º—É—é
- –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∞–π–ª–∞

```bash
# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤
capinfos VroomVroom.pcapng

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
tshark -r VroomVroom.pcapng -Y "http.request" | wc -l

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
tshark -r VroomVroom.pcapng -Y "http.request" -T fields -e http.request.uri | sort -u
```

---

## üéì –ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏

1. **–§–æ—Ä–º–∞—Ç .pcapng** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
2. **strings** - –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∏–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç –∏–∑ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. **awk** - –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ –ø–æ–ª—è–º
4. **HTTP** - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –ª–µ–≥–∫–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
5. **URL encoding** - –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
6. **Data exfiltration** - —Ç–µ—Ö–Ω–∏–∫–∞ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø–æ—Ä—Ü–∏—è–º–∏

---

## üöÄ –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
strings VroomVroom.pcapng | grep flag | awk -F'=' '{ print $3 }' | awk -F'&' '{ print $1 }' | tr -d '\n' | python3 -c "import sys; from urllib.parse import unquote; print(unquote(sys.stdin.read().strip()))"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
DUCKERZ{c4n_f0r_DuCk5}
```

---

## üéØ –§–ª–∞–≥

```
DUCKERZ{c4n_f0r_DuCk5}
```

*–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞: "can for Ducks" - –∏–≥—Ä–∞ —Å–ª–æ–≤ –Ω–∞ —Ç–µ–º—É —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø–æ—Ä—Ü–∏—è–º–∏ (can = –∫–æ–Ω—Å–µ—Ä–≤–Ω–∞—è –±–∞–Ω–∫–∞, –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ—Ä—Ü–∏–∏)*
